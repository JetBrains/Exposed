<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2024-12-06T09:08:37.606782171"><title>Frequently Asked Questions | Exposed</title><script type="application/json" id="virtual-toc-data">[{"id":"q-squash-is-same-as-exposed-where-is-the-difference","level":0,"title":"Q: Squash is same as Exposed. Where is the difference?","anchor":"#q-squash-is-same-as-exposed-where-is-the-difference"},{"id":"q-can-i-use-multiple-database-connections","level":0,"title":"Q: Can I use multiple Database Connections?","anchor":"#q-can-i-use-multiple-database-connections"},{"id":"q-is-array-column-type-supported","level":0,"title":"Q: Is Array column type supported?","anchor":"#q-is-array-column-type-supported"},{"id":"q-is-upsert-supported","level":0,"title":"Q: Is upsert supported?","anchor":"#q-is-upsert-supported"},{"id":"q-is-json-type-supported","level":0,"title":"Q: Is json type supported?","anchor":"#q-is-json-type-supported"},{"id":"q-how-to-get-a-plain-sql-query-which-will-be-executed","level":0,"title":"Q: How to get a plain SQL query which will be executed?","anchor":"#q-how-to-get-a-plain-sql-query-which-will-be-executed"},{"id":"q-is-it-possible-to-use-native-sql-sql-as-a-string","level":0,"title":"Q: Is it possible to use native sql / sql as a string?","anchor":"#q-is-it-possible-to-use-native-sql-sql-as-a-string"},{"id":"q-is-it-possible-to-update-a-field-relative-to-current-field-value","level":0,"title":"Q: Is it possible to update a field relative to current field value?","anchor":"#q-is-it-possible-to-update-a-field-relative-to-current-field-value"},{"id":"q-how-can-i-add-another-type-of-database","level":0,"title":"Q: How can I add another type of Database?","anchor":"#q-how-can-i-add-another-type-of-database"},{"id":"q-is-it-possible-to-create-tables-with-cross-cyclic-reference","level":0,"title":"Q: Is it possible to create tables with cross / cyclic reference?","anchor":"#q-is-it-possible-to-create-tables-with-cross-cyclic-reference"},{"id":"q-how-can-i-implement-nested-queries","level":0,"title":"Q: How can I implement nested queries?","anchor":"#q-how-can-i-implement-nested-queries"},{"id":"q-how-can-i-use-savepoint","level":0,"title":"Q: How can I use SAVEPOINT?","anchor":"#q-how-can-i-use-savepoint"},{"id":"q-how-to-prepare-query-like-select-from-table-where-x-y-in-1-2-3-4-5-6","level":0,"title":"Q: How to prepare query like: SELECT * FROM table WHERE (x,y) IN ((1, 2), (3, 4), (5, 6))","anchor":"#q-how-to-prepare-query-like-select-from-table-where-x-y-in-1-2-3-4-5-6"},{"id":"q-where-can-i-find-snapshot-builds-of-exposed","level":0,"title":"Q: Where can I find snapshot builds of Exposed","anchor":"#q-where-can-i-find-snapshot-builds-of-exposed"},{"id":"q-how-can-i-create-a-custom-column-type","level":0,"title":"Q: How can I create a custom column type?","anchor":"#q-how-can-i-create-a-custom-column-type"},{"id":"more-questions-on-stack-overflow","level":0,"title":"More questions on Stack Overflow:","anchor":"#more-questions-on-stack-overflow"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b267/app.css" rel="stylesheet"><link rel="icon" type="image/svg" sizes="16x16" href="images/exposed-logo.svg"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Frequently Asked Questions | Exposed"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Exposed Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/docs/0.57.0/frequently-asked-questions.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Frequently Asked Questions | Exposed"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/docs/0.57.0/frequently-asked-questions.html#webpage",
    "url": "writerside-documentation/docs/0.57.0/frequently-asked-questions.html",
    "name": "Frequently Asked Questions | Exposed",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/docs/#website",
    "url": "writerside-documentation/docs/",
    "name": "Exposed Help"
}</script><!-- End Schema.org --></head><body data-id="Frequently-Asked-Questions" data-main-title="Frequently Asked Questions" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs=""><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Exposed 0.57.0 Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Frequently-Asked-Questions" id="Frequently-Asked-Questions.md">Frequently Asked Questions</h1><section class="chapter"><h2 id="q-squash-is-same-as-exposed-where-is-the-difference" data-toc="q-squash-is-same-as-exposed-where-is-the-difference">Q: <a href="https://github.com/orangy/squash" id="lmia3x_3" data-external="true" rel="noopener noreferrer">Squash</a> is same as Exposed. Where is the difference?</h2><p id="lmia3x_4">A: <a href="https://github.com/orangy/" id="lmia3x_5" data-external="true" rel="noopener noreferrer">Ilya Ryzhenkov</a> (Squash maintainer) answers:</p><aside class="prompt" data-type="tip" data-title="" id="lmia3x_6"><p id="lmia3x_7">Squash is an attempt to refactor Exposed (long time ago) to fix DSL issues, extensibility on dialect side, support graph fetching and avoid TLS-stored transactions. Unfortunately, I didn&rsquo;t have enough time to finish the work, but I still hope to return to it some day. We are talking with Exposed maintainer <a href="https://github.com/orangy/" id="lmia3x_8" data-external="true" rel="noopener noreferrer">@tapac</a> about coordinating efforts and eventually joining forces. Note, that none of these libs are &ldquo;official&rdquo; JetBrains Kotlin SQL libs, they are both side projects of their respective authors.</p></aside></section><section class="chapter"><h2 id="q-can-i-use-multiple-database-connections" data-toc="q-can-i-use-multiple-database-connections">Q: Can I use multiple Database Connections?</h2><p id="lmia3x_9">A: Yes. See <a href="transactions.html#working-with-multiple-databases" id="lmia3x_10" data-tooltip="If you want to work with different databases, you have to store the database reference returned by Database.connect() and provide it to transaction function as the first parameter. The transaction block without parameters will work with the latest connected database.">Transactions</a></p></section><section class="chapter"><h2 id="q-is-array-column-type-supported" data-toc="q-is-array-column-type-supported">Q: Is <code class="code" id="lmia3x_12">Array</code> column type supported?</h2><p id="lmia3x_13">A: Yes. See <a href="data-types.html#how-to-use-array-types" id="lmia3x_14" data-tooltip="PostgreSQL and H2 databases support the explicit ARRAY data type, with multi-dimensional arrays being supported by PostgreSQL.">Data Types</a>.</p></section><section class="chapter"><h2 id="q-is-upsert-supported" data-toc="q-is-upsert-supported">Q: Is <code class="code" id="lmia3x_16">upsert</code> supported?</h2><p id="lmia3x_17">A: Yes. See <a href="dsl-crud-operations.html#insert-or-update" id="lmia3x_18" data-tooltip="Insert or update (Upsert) is a database operation that either inserts a new row or updates an existing row if a duplicate constraint already exists. The supported functionality of upsert() is dependent on the specific database being used. For example, MySQL's INSERT ... ON DUPLICATEâ€¦">Insert Or Update</a></p></section><section class="chapter"><h2 id="q-is-json-type-supported" data-toc="q-is-json-type-supported">Q: Is <code class="code" id="lmia3x_20">json</code> type supported?</h2><p id="lmia3x_21">A: Yes. See <a href="data-types.html#how-to-use-json-and-jsonb-types" id="lmia3x_22" data-tooltip="Add the following dependencies to your build.gradle.kts:">JSON</a></p></section><section class="chapter"><h2 id="q-how-to-get-a-plain-sql-query-which-will-be-executed" data-toc="q-how-to-get-a-plain-sql-query-which-will-be-executed">Q: How to get a plain SQL query which will be executed?</h2><p id="lmia3x_23">A:</p><div class="code-block" data-lang="kotlin">
val plainSQL = FooTable.selectAll().where {}.prepareSQL(QueryBuilder(false)) 
</div><p id="lmia3x_25">Use QueryBuiler with <code class="code" id="lmia3x_26">false</code> - if you want to inline statement arguments, <code class="code" id="lmia3x_27">true</code> - to see '?' in query.</p></section><section class="chapter"><h2 id="q-is-it-possible-to-use-native-sql-sql-as-a-string" data-toc="q-is-it-possible-to-use-native-sql-sql-as-a-string">Q: Is it possible to use native sql / sql as a string?</h2><p id="lmia3x_28">A: It is not supported as part of the library, but it is possible to implement on top of it and use it like this:</p><div class="code-block" data-lang="kotlin">
fun &lt;T:Any&gt; String.execAndMap(transform : (ResultSet) -&gt; T) : List&lt;T&gt; {
     val result = arrayListOf&lt;T&gt;()
     TransactionManager.current().exec(this) { rs -&gt;
          while (rs.next()) {
               result += transform(rs)
          }
     }
     return result
}

&quot;select u.name, c.name from user u inner join city c where blah blah&quot;.execAndMap { rs -&gt;
    rs.getString(&quot;u.name&quot;) to rs.getString(&quot;c.name&quot;) 
}
</div><p id="lmia3x_30">More info in this issue: <a href="https://github.com/JetBrains/Exposed/issues/118" id="lmia3x_31" data-external="true" rel="noopener noreferrer">https://github.com/JetBrains/Exposed/issues/118</a></p></section><section class="chapter"><h2 id="q-is-it-possible-to-update-a-field-relative-to-current-field-value" data-toc="q-is-it-possible-to-update-a-field-relative-to-current-field-value">Q: Is it possible to update a field relative to current field value?</h2><p id="lmia3x_32">A: Yes. See example here: <a href="https://github.com/JetBrains/Exposed/issues/118" id="lmia3x_33" data-external="true" rel="noopener noreferrer">https://github.com/JetBrains/Exposed/wiki/DSL#update</a></p></section><section class="chapter"><h2 id="q-how-can-i-add-another-type-of-database" data-toc="q-how-can-i-add-another-type-of-database">Q: How can I add another type of Database?</h2><p id="lmia3x_34">A: Implement <code class="code" id="lmia3x_35">DatabaseDialect</code> interface and register it with <code class="code" id="lmia3x_36">Database.registerDialect()</code>. <br> If the implementation adds a lot of value consider contributing it as a PR to Exposed.</p></section><section class="chapter"><h2 id="q-is-it-possible-to-create-tables-with-cross-cyclic-reference" data-toc="q-is-it-possible-to-create-tables-with-cross-cyclic-reference">Q: Is it possible to create tables with cross / cyclic reference?</h2><p id="lmia3x_38">A: Yes, it's possible since Exposed 0.11.1 version</p></section><section class="chapter"><h2 id="q-how-can-i-implement-nested-queries" data-toc="q-how-can-i-implement-nested-queries">Q: How can I implement nested queries?</h2><p id="lmia3x_39">A: See example here: <a href="https://github.com/JetBrains/Exposed/issues/118" id="lmia3x_40" data-external="true" rel="noopener noreferrer">https://github.com/JetBrains/Exposed/issues/248</a></p></section><section class="chapter"><h2 id="q-how-can-i-use-savepoint" data-toc="q-how-can-i-use-savepoint">Q: How can I use SAVEPOINT?</h2><p id="lmia3x_41">A: It possible only through using a raw connection. See example <a href="https://github.com/JetBrains/Exposed/issues/320#issuecomment-394825415" id="lmia3x_42" data-external="true" rel="noopener noreferrer">here</a>.</p></section><section class="chapter"><h2 id="q-how-to-prepare-query-like-select-from-table-where-x-y-in-1-2-3-4-5-6" data-toc="q-how-to-prepare-query-like-select-from-table-where-x-y-in-1-2-3-4-5-6">Q: How to prepare query like: <code class="code" id="lmia3x_44">SELECT * FROM table WHERE (x,y) IN ((1, 2), (3, 4), (5, 6))</code></h2><p id="lmia3x_45">A: It possible with custom function. See <a href="https://github.com/JetBrains/Exposed/issues/373#issuecomment-414123325" id="lmia3x_46" data-external="true" rel="noopener noreferrer">example</a>.</p></section><section class="chapter"><h2 id="q-where-can-i-find-snapshot-builds-of-exposed" data-toc="q-where-can-i-find-snapshot-builds-of-exposed">Q: Where can I find snapshot builds of Exposed</h2><p id="lmia3x_47">A: You could use jitpack.io service for that.</p><p id="lmia3x_48">Add jitpack.io to repositories:</p><div class="code-block" data-lang="none">
repositories {
    maven { url 'https://jitpack.io' }
}
</div><p id="lmia3x_50">Then add Exposed dependency as stated below:</p><div class="code-block" data-lang="none">
dependencies {
    implementation 'com.github.JetBrains:Exposed:-SNAPSHOT'
}
</div></section><section class="chapter"><h2 id="q-how-can-i-create-a-custom-column-type" data-toc="q-how-can-i-create-a-custom-column-type">Q: How can I create a custom column type?</h2><p id="lmia3x_52">A: Just implements <a href="https://github.com/JetBrains/Exposed/blob/76a671e57a0105d6aed79e256c088690bd4a56b6/exposed-core/src/main/kotlin/org/jetbrains/exposed/sql/ColumnType.kt#L25" id="lmia3x_53" data-external="true" rel="noopener noreferrer">IColumnType</a> and use <a href="https://github.com/JetBrains/Exposed/blob/76a671e57a0105d6aed79e256c088690bd4a56b6/exposed-core/src/main/kotlin/org/jetbrains/exposed/sql/Table.kt#L387" id="lmia3x_54" data-external="true" rel="noopener noreferrer">registerColumn</a> to <a href="https://kotlinlang.org/docs/extensions.html" id="lmia3x_55" data-external="true" rel="noopener noreferrer">extends</a> a <a href="https://github.com/JetBrains/Exposed/blob/76a671e57a0105d6aed79e256c088690bd4a56b6/exposed-core/src/main/kotlin/org/jetbrains/exposed/sql/Table.kt#L326" id="lmia3x_56" data-external="true" rel="noopener noreferrer">Table</a></p><p id="lmia3x_57">eg: <span class="control" id="lmia3x_58">Create custom UUID types (inpired by <a href="https://medium.com/@pjagielski/how-we-use-kotlin-with-exposed-at-touk-eacaae4565b5#e4e4" id="lmia3x_59" data-external="true" rel="noopener noreferrer">@pjagielski article</a>)</span></p><div class="code-block" data-lang="kotlin">
abstract class TypedId(open val id: UUID): Serializable, Comparable&lt;TypedId&gt; {
    override fun compareTo(other: TypedId) = this.id.compareTo(other.id)
}

class TypedUUIDColumnType&lt;T: TypedId&gt;(val constructor: (UUID) -&gt; T, private val uuidColType: UUIDColumnType = UUIDColumnType()): IColumnType by uuidColType {
    override fun valueFromDB(value: Any) = constructor(uuidColType.valueFromDB(value))
    override fun notNullValueToDB(value: Any): Any = uuidColType.notNullValueToDB(valueUnwrap(value))
    override fun nonNullValueToString(value: Any): String = uuidColType.nonNullValueToString(valueUnwrap(value))
    private fun valueUnwrap(value: Any) = (value as? TypedId)?.id ?: value
}

fun &lt;T: TypedId&gt; Table.typedUuid(name: String, constructor: (UUID) -&gt; T) = registerColumn&lt;T&gt;(name, TypedUUIDColumnType&lt;T&gt;(constructor))
fun &lt;T: TypedId&gt; Column&lt;T&gt;.autoGenerate(constructor: (UUID) -&gt; T): Column&lt;T&gt; = clientDefault { constructor(UUID.randomUUID()) }


class StarWarsFilmId(id: UUID): TypedId(id)

object StarWarsFilms : Table() {
    val id = typedUuid(&quot;id&quot;) { StarWarsFilmId(it) }.autoGenerate{ StarWarsFilmId(it) }
    val name: Column&lt;String&gt; = varchar(&quot;name&quot;, 50)
    val director: Column&lt;String&gt; = varchar(&quot;director&quot;, 50)
    final override val primaryKey = PrimaryKey(id)
}
</div><p id="lmia3x_61">Reference: <a href="https://github.com/JetBrains/Exposed/issues/149" id="lmia3x_62" data-external="true" rel="noopener noreferrer">#149</a></p></section><section class="chapter"><h2 id="more-questions-on-stack-overflow" data-toc="more-questions-on-stack-overflow">More questions on Stack Overflow:</h2><p id="lmia3x_63"><a href="https://stackoverflow.com/questions/tagged/kotlin-exposed" id="lmia3x_64" data-external="true" rel="noopener noreferrer">https://stackoverflow.com/questions/tagged/kotlin-exposed</a></p></section><div class="last-modified">Last modified: 05 December 2024</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="migration-guide.html" class="navigation-links__prev">Migrating from 0.45.0 to 0.46.0</a><a href="contributing.html" class="navigation-links__next">Contributing to Exposed</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b267/app.js"></script></body></html>